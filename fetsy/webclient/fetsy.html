<!DOCTYPE html>
<html lang="en" ng-app="FeTSy" ng-strict-di>

<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" href="favicon.ico">

    <title>FeTSy</title>

    <!-- Libraries styles -->
    <link rel="stylesheet" href="css/fetsy-libs.css">

    <!-- Custom styles -->
    <link rel="stylesheet" href="css/fetsy.css">

    <!-- HTML5 Shiv and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="js/html5shiv.js"></script>
        <script src="js/respond.src.js"></script>
    <![endif]-->

    <!-- Libraries JavaScript -->
    <script src="js/fetsy-libs.js"></script>

    <!-- Custom JavaScript -->
    <script src="js/fetsy.js"></script>

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="js/ie10-viewport-bug-workaround.js"></script>
</head>

<body>

    <!-- Top navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top" ng-controller="NavbarCtrl as navbarCtrl">
        <div class="container">
            <div class="navbar-header">
                <button type="button"
                        class="navbar-toggle collapsed"
                        data-toggle="collapse"
                        data-target="#navbar"
                        aria-expanded="false"
                        aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#">FeTSy</a>
            </div>
            <div id="navbar" class="collapse navbar-collapse">
                <ul class="nav navbar-nav">
                    <li ng-show="navbarCtrl.userIsStaff"><a href="#">Administration</a></li>
                    <li ng-show="navbarCtrl.userIsStaff"><a href="#">REST API</a></li>
                    <li><a href="#">Log out</a></li>
                </ul>
            </div>
        </div>
    </nav><!-- / .navbar Top navbar -->


    <!-- Main container -->
    <div class="container">

        <div style="padding: 2.9em 1.1em;">

            <!-- Connection open message -->
            <div class="row" ng-controller="ConnectionMessageCtrl as connectionMessage">
                <div class="col-sm-offset-2 col-sm-8">
                    <uib-alert type="success" ng-show="connectionMessage.connectionOpen">
                        Connection established. Have a nice day.
                    </uib-alert>
                    <uib-alert type="warning" ng-hide="connectionMessage.connectionOpen">
                        Connection failed. Please reload the page or call the server administrator.
                    </uib-alert>
                </div>
            </div><!-- / .row Connection open message -->

            <!-- Pagination bar -->
            <div class="row" ng-controller="PaginationCtrl as pagination">
                <div class="col-sm-12">
                    <uib-pagination total-items="pagination.totalItems"
                                items-per-page="pagination.itemsPerPage"
                                max_size="7"
                                ng-model="pagination.paginationPage"
                                ng-change="pagination.change()"
                                boundary-links="true"
                                class="pagination-sm">
                    </uib-pagination>
                </div>
            </div><!-- / .row Pagination bar -->

            <!-- Top functionality row -->
            <div class="row" style="padding-bottom:1.5em;" ng-controller="TopRowCtrl as topRow">

                <!-- New ticket button -->
                <div class="col-sm-3">
                    <button type="button"
                            class="btn btn-primary"
                            ng-show="topRow.newTicketForm"
                            ng-click="topRow.newTicketForm()">
                        <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
                        New Ticket
                    </button>
                </div><!-- / .col-sm-3 New ticket button -->

                <!-- Show remaining time in minutes checkbox -->
                <div class="col-sm-3">
                    <div class="checkbox">
                        <label>
                            <input type="checkbox" ng-model="topRow.remainingTimeValue" ng-change="topRow.remainingTimeChange()">
                            Show remaining time in minutes
                        </label>
                    </div>
                </div><!-- / .col-sm-3 Show remaining time in minutes checkbox-->

                <!-- Hide closed tickets checkbox -->
                <div class="col-sm-3">
                    <div class="checkbox">
                        <label>
                            <input type="checkbox" ng-model="topRow.closedValue" ng-change="topRow.closedChange()">
                            Hide closed tickets
                        </label>
                    </div>
                </div><!-- / .col-sm-3 Hide closed tickets checkbox -->

                <!-- Search bar for filtering the table -->
                <div class="col-sm-3">
                    <form role="form" class="form-inline">
                        <div class="form-group">
                            <label for="search" class="sr-only">
                                Search
                            </label>
                            <div class="input-group">
                                <div class="input-group-addon">
                                    <span id="searchIcon" class="glyphicon glyphicon-search" aria-hidden="true"></span>
                                    <span class="sr-only">Search</span>
                                </div>
                                <input id="search"
                                       type="text"
                                       class="form-control"
                                       placeholder="Search"
                                       aria-describedby="searchIcon"
                                       ng-model="topRow.searchValue"
                                       ng-change="topRow.searchChange()">
                                <div class="input-group-btn">
                                    <span type="button"
                                          title="Reset search field"
                                          class="btn btn-default"
                                          ng-click="topRow.searchValue = ''; topRow.searchChange()">
                                        <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
                                        <span class="sr-only">Reset search field</span>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </form>
                </div><!-- / .col-sm-3 Search bar for filtering the table -->

            </div><!-- / .row Top functionality row -->

            <!-- Ticket list -->
            <div ng-controller="TicketListCtrl as tickets">

                <!-- Ticket list header -->
                <div class="row ticket-row ticket-list-header">

                    <!-- Header for extra small devices -->
                    <div ng-repeat="header in tickets.headers"
                         class="col-xs-2 visible-xs-inline"
                         ng-click="tickets.toggleSort(header.sortKey)">
                        <a role="button">
                            <span ng-show="$first"
                                  title="{{ header.getDisplayName() }}">
                                #
                            </span>
                            <span ng-hide="$first"
                                  title="{{ header.getDisplayName() }}"
                                  class="glyphicon"
                                  ng-class="header.getIconCSSClass()"
                                  aria-hidden="true">
                            </span>
                        </a>
                        <span class="pull-right"
                              ng-class="tickets.reverse ? null : 'dropup'"
                              ng-show="tickets.sortColumn === header.sortKey">
                            <span class="caret"></span>
                        </span>
                    </div>

                    <!-- Header for small devices and greater -->
                    <div ng-repeat="header in tickets.headers"
                         class="hidden-xs"
                         ng-class="header.col"
                         ng-click="tickets.toggleSort(header.sortKey)">
                        <a role="button">
                            <span ng-show="$first"
                                  title="{{ header.getDisplayName() }}">
                                #
                            </span>
                            <span ng-hide="$first"
                                  title="{{ header.getDisplayName() }}"
                                  class="glyphicon"
                                  ng-class="header.getIconCSSClass()"
                                  aria-hidden="true">
                            </span>
                        </a>
                        <span class="pull-right"
                              ng-class="tickets.reverse ? null : 'dropup'"
                              ng-show="tickets.sortColumn === header.sortKey">
                            <span class="caret"></span>
                        </span>
                    </div>

                </div><!-- / .row Ticket list header -->

                <!-- Ticket list body -->
                <div class="row ticket-row"
                     ng-repeat="ticket in tickets.all |
                                orderBy : tickets.sortColumn : tickets.reverse |
                                filter : tickets.getSearch() |
                                filter: tickets.closedFilter |
                                limitTo : tickets.itemsPerPage : tickets.getPaginationBegin()
                                as filteredTickets"
                     ng-class-odd="'ticket-row-odd'">

                    <!-- Ticket columns -->
                    <div ng-repeat="header in tickets.headers"
                         ng-class="header.col">
                        <span ng-hide="$first"
                              title="{{ header.getDisplayName() }}"
                              class="glyphicon visible-xs-inline"
                              ng-class="header.getIconCSSClass()"
                              aria-hidden="true">
                        </span>
                        {{ ticket[header.sortKey] }}
                    </div><!-- / Ticket columns -->

                    <!-- Button column -->
                    <div class="col-sm-1">
                        <span class="pull-right">
                            <button type="button"
                                    title="Close ticket"
                                    class="btn btn-xs btn-success"
                                    ng-show="ticket.status !== 'Closed'"
                                    ng-click="ticket.close()">
                                <span class="glyphicon glyphicon-ok" aria-hidden="true"></span>
                                <span class="sr-only">Close ticket</span>
                            </button>
                            <button type="button"
                                    title="Get more info"
                                    class="btn btn-xs btn-info"
                                    ng-click="ticket.openInfo()">
                                <span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span>
                                <span class="sr-only">Get more info</span>
                            </button>
                        </span>
                    </div><!-- / Button column -->

                </div><!-- / .row Ticket list body -->

                <!-- Ticket list body empty -->
                <div class="row ticket-row ticket-row-odd"
                     ng-show="filteredTickets.length == 0">

                     <div class="col-sm-8 col-sm-offset-2">
                        No tickets found. Try to move back in the pagination bar or reset the checkboxes or search field.
                     </div>

                </div><!-- / .row Ticket list body empty -->

                <!-- Second ticket list header -->
                <div class="row ticket-row ticket-row-last ticket-list-header"
                     ng-class="filteredTickets.length === 0 || filteredTickets.length % 2 !== 0 ? '' : 'ticket-row-odd'">

                    <!-- Second header for extra small devices -->
                    <!-- None -->

                    <!-- Second header for small devices and greater -->
                    <div ng-repeat="header in tickets.headers"
                         class="hidden-xs"
                         ng-class="header.col">
                        <span ng-show="$first"
                              title="{{ header.getDisplayName() }}">
                            #
                        </span>
                        <span ng-hide="$first"
                              title="{{ header.getDisplayName() }}"
                              class="glyphicon"
                              ng-class="header.getIconCSSClass()"
                              aria-hidden="true">
                        </span>
                    </div>

                </div><!-- / .row Second ticket list header -->

            </div><!-- / Ticket list -->

        </div>

        <hr>

        <footer>
            <p>&copy; 2015–2016 <a href="http://rechtsanwalt-jaeckel.de">Norman Jäckel</a></p>
        </footer>

    </div><!-- / Main container -->

    <!-- New ticket form modal -->
    <script type="text/ng-template" id="newTicketForm.html">

        <!-- New ticket form modal header -->
        <div class="modal-header">
            <h3 class="modal-title">
                New ticket
            </h3>
        </div><!-- / .modal-header New ticket form modal header -->

        <!-- New ticket form modal body -->
        <div class="modal-body">
            <div class="form-group">
                <label for="newTicketPeriodOrDeadline" class="sr-only">
                    <span ng-if="newTicketForm.remainingTimeValue">Period. Default: 120 minutes.</span>
                    <span ng-if="!newTicketForm.remainingTimeValue">Deadline. Default: Time in 120 minutes.</span>
                </label>
                <div class="input-group">
                    <div class="input-group-addon">
                        <span ng-show="newTicketForm.remainingTimeValue"
                              id="newTicketPeriodOrDeadlineIcon"
                              title="Period (in minutes)"
                              class="glyphicon glyphicon-hourglass"
                              aria-hidden="true">
                        </span>
                        <span ng-hide="newTicketForm.remainingTimeValue"
                              id="newTicketPeriodOrDeadlineIcon"
                              title="Deadline"
                              class="glyphicon glyphicon-time"
                              aria-hidden="true">
                        </span>
                    </div>
                    <input id="newTicketPeriodOrDeadline"
                           type="text"
                           class="form-control"
                           aria-describedby="newTicketPeriodOrDeadlineIcon"
                           required
                           ng-model="newTicketForm.periodOrDeadlineField">
                </div>
            </div>
            <div class="form-group">
                <label for="newTicketContent" class="sr-only">
                    Content
                </label>
                <textarea id="newTicketContent"
                          placeholder="Content"
                          class="form-control"
                          rows="3"
                          required
                          ng-model="newTicketForm.contentField">
                </textarea>
            </div>
        </div><!-- / .modal-body New ticket form modal body -->

        <!-- New ticket form modal footer -->
        <div class="modal-footer">
            <button type="button" class="btn btn-primary" ng-click="newTicketForm.save()">
                Save
            </button>
            <button type="button" class="btn btn-default" ng-click="newTicketForm.cancel()">
                Cancel
            </button>
        </div><!-- / .modal-footer New ticket form modal footer -->

    </script><!-- / New ticket form modal -->

    <!-- Ticket info modal -->
    <script type="text/ng-template" id="ticketInfo.html">

        <!-- Ticket info modal header -->
        <div class="modal-header">
            <h3 class="modal-title">
                Ticket #{{ ticketInfo.ticket.id }}
                <span ng-show="ticketInfo.ticket.status === 'Closed'"
                      title="Closed"
                      class="pull-right glyphicon glyphicon-ok"
                      aria-hidden="true">
                </span>
            </h3>
        </div><!-- / .modal-header Ticket info modal header -->

        <!-- Ticket info modal body -->
        <div class="modal-body">
            {{ ticketInfo.ticket.content }}
        </div><!-- / Ticket info modal body -->

        <!-- Ticket info modal footer -->
        <div class="modal-footer">
            Created {{ ticketInfo.ticket.created | amFromUnix | amDateFormat : 'YYYY-MM-DD hh:mm' }} by ...
        </div><!-- / Ticket info modal footer -->

    </script><!-- / Ticket info modal -->

</body>

</html>
